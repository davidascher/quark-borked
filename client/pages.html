<head>
  <title>Playing w/ meteor and fedwiki</title>
  <link rel='stylesheet' type='text/css' href='/app.css'>
</head>
<body>
  {{>main}}
  <script src="/showdown.js"></script>
</body>

<template name="main">
<div id="root">
  <div class="container-fluid main">
    <div class="row-fluid">
      <div class="span2">
        <div class="well sidebar-nav">
          <ul class="nav nav-list">
            {{>heartedpages}}
            {{>recentpages}}
        </div><!--/.well -->
      </div><!--/span-->
      <div class="span5">
        <div class="card">
          {{> page}}
        </div>
      </div>
      <div class="span4">
        <div class="searchfield">
          <form class="form-search">
            <input type="text" class="input-medium search-query">
            <button type="submit" class="btn">Search</button>
          </form>
        </div>
      </div>
    </div>
  </div>
</div>
</template>

<template name="redirected">
  {{#if redirected_from}}
  <span class="redirected-from">You were redirected here from '{{redirected_from}}', a page which was renamed to '{{pageName}}'</span>
  {{/if}}
</template>

<template name="heartedpages">
    {{#if pages.count}}
      <li class="nav-header">
        <i class="heart icon-heart starred"></i> pages
      </li>
      {{#each pages}}
      <li><a class="internal" data="{{name}}" href="{{name}}">{{name}}</a>
      </li>
      {{/each}}
    {{/if}}
</template>

<template name="recentpages">
  <li class="nav-header">Recent pages</li>
  {{#each pages}}
  <li><a class="internal" data="{{name}}" href="{{name}}">{{name}}</a>
  </li>
  {{/each}}
</template>

<template name="para">
  <div class="ui-state-default draggable">
    <span class="drag-handle">¶</span>
    <!-- <i class="icon-align-justify drag-handle"></i> -->
    <div>
      <p class="para" data-id='{{_id}}' data-index='{{index}}'>
        {{#if editing}}
            <textarea id="para-textarea" class='editable'>{{this.content}}</textarea>
        <i class="icon-remove-circle done-handle"></i>
        {{else}}<span class='editable'>
  {{#linkify this.content}}{{/linkify}}</span>
          <i class="icon-pencil edit-handle"></i>
        {{/if}}
      </p>
    </div>
    <div class="clear"/>
  </div>
</template>

<template name="heart">
  {{#if starred}}
    <i class="heart icon-heart starred"></i>
  {{else}}
    <i class="heart icon-heart-empty unstarred"></i>
  {{/if}}
</template>

<template name="page">
  <h3 class="page-name">{{>editablepagetitle currentPage}} {{>heart}}</h3>
  <div id="pages">
    <div id="sortable">
      {{#each paras}}
        {{> para}}
      {{/each}}
    </div>
    <div class="buttonbar">
      {{>newpara}}
      {{>newpage}}
      {{>newlink}}
      {{>newothers}}
    </div>
  </div>
</template>

<template name="editablepagetitle">
  {{#if editing_title}}
    <input type="text" id="title-input" class="editing-title" value="{{ this }}"></input>
  {{else}}
    <span class="pagetitle">
      {{ this }}
    </span>
  {{/if}}
</template>

<template name="newpara">
  <button class="new-para btn">+ ¶&nbsp;</button>
</template>
<template name="newpage">
  <button class="new-page btn">+ <i class="icon-file"></i></button>
</template>
<template name="newlink">
  <button class="new-link btn">+ <i class="icon-link"></i></button>
</template>
<template name="newothers">
  <div class="btn-group">
    <a class="btn dropdown-toggle  new-others" data-toggle="dropdown" href="#">
    + …
    <span class="caret"></span>
    </a>
    <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenu">
      <li><a tabindex="-1" href="#">Image</a></li>
      <li><a tabindex="-1" href="#">Data</a></li>
      <li><a tabindex="-1" href="#">Visualization</a></li>
      <li class="divider"></li>
      <li><a tabindex="-1" href="#">Plugin…</a></li>
    </ul>
  </div>
</template>